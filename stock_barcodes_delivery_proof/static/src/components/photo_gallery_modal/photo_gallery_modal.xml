<?xml version="1.0" encoding="UTF-8"?>
<templates xml:space="preserve">
<t t-name="stock_barcodes_delivery_proof.PhotoGalleryModal" owl="1">
        <Dialog title="'Delivery Proof Photos'" size="'lg'">
            <t t-set-slot="footer">
                <button class="btn btn-secondary" t-on-click="closeModal">
                    Close
                </button>
            </t>
            <div class="photo-gallery-modal">
                <!-- Camera view -->
                <t t-if="state.showCamera">
                    <CameraCapture
                        onCapture.bind="onPhotoCapture"
                        onClose.bind="onCloseCamera"
                    />
                </t>

                <!-- Gallery view -->
                <t t-else="">
                    <!-- Stats bar -->
                    <div class="gallery-stats mb-3 p-2 bg-light rounded">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <i class="fa fa-images" />
                                <strong t-esc="state.stats.total_count" /> photo(s)
                                <span
                                    class="text-muted ml-2"
                                    t-if="state.mode === 'move_line'"
                                >
                                    for
                                    <t t-esc="state.stats.lines_count" />
                                    line(s)
                                </span>
                                <span
                                    class="text-muted ml-2"
                                    t-if="state.mode === 'picking'"
                                >
                                    for picking
                                </span>
                            </div>
                            <button
                                class="btn btn-primary btn-sm"
                                t-on-click="onAddPhoto"
                            >
                                <i class="fa fa-camera" />
                                Add Photo
                            </button>
                        </div>
                    </div>

                    <!-- Loading state -->
                    <t t-if="state.loading">
                        <div class="text-center py-5">
                            <i class="fa fa-spinner fa-spin fa-3x text-primary" />
                            <p class="mt-3 text-muted">Loading photos...</p>
                        </div>
                    </t>

                    <!-- Empty state -->
                    <t t-elif="state.photos.length === 0">
                        <div class="alert alert-info text-center py-5">
                            <i class="fa fa-camera fa-3x mb-3" />
                            <h5>No photos yet</h5>
                            <p class="mb-0">
                                Click "Add Photo" to capture your first delivery proof photo
                            </p>
                        </div>
                    </t>

                    <!-- Photo gallery -->
                    <t t-else="">
                        <ImageCarousel
                            images="state.photos"
                            onDelete.bind="onDeletePhoto"
                            readonly="false"
                        />

                        <!-- Photo metadata (showing current photo info) -->
                        <div class="photo-metadata mt-3 p-3 bg-light rounded">
                            <t t-if="state.photos.length > 0">
                                <t t-set="currentPhoto" t-value="state.photos[0]" />

                                <!-- Move line mode metadata -->
                                <div class="row" t-if="state.mode === 'move_line'">
                                    <div class="col-6">
                                        <small class="text-muted">Product:</small>
                                        <br />
                                        <strong t-esc="currentPhoto.product_name" />
                                    </div>
                                    <div class="col-6" t-if="currentPhoto.lot_name">
                                        <small class="text-muted">Lot/Serial:</small>
                                        <br />
                                        <strong t-esc="currentPhoto.lot_name" />
                                    </div>
                                    <div class="col-6 mt-2" t-if="currentPhoto.qty">
                                        <small class="text-muted">Quantity:</small>
                                        <br />
                                        <strong>
                                            <t t-esc="currentPhoto.qty" />
                                            <t t-esc="currentPhoto.uom" />
                                        </strong>
                                    </div>
                                </div>

                                <!-- Picking mode metadata -->
                                <div class="row" t-if="state.mode === 'picking'">
                                    <div class="col-6">
                                        <small class="text-muted">Picking:</small>
                                        <br />
                                        <strong t-esc="currentPhoto.picking_name" />
                                    </div>
                                    <div class="col-6">
                                        <small class="text-muted">Captured:</small>
                                        <br />
                                        <strong t-esc="currentPhoto.capture_date" />
                                    </div>
                                </div>
                            </t>
                        </div>
                    </t>
                </t>
            </div>
        </Dialog>
    </t>
</templates>